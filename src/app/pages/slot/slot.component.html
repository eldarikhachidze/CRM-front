<div class="slot-machine-list">
  <div class="grid-container">
    <div class="table-container">
      <div *ngFor="let hall of slotPitData.halls">
        <!-- Hall Name -->
        <h2>{{ hall.name }}</h2>

        <!-- Slot Machines Table -->
        <table mat-table [dataSource]="hall.slot_machines" class="mat-elevation-z8">

          <!-- Name Column -->
          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef> Name</th>
            <td mat-cell *matCellDef="let slotMachine"> {{ slotMachine.name }} </td>
          </ng-container>

          <!-- Brand Column -->
          <ng-container matColumnDef="brand">
            <th mat-header-cell *matHeaderCellDef> Brand</th>
            <td mat-cell *matCellDef="let slotMachine"> {{ slotMachine.brand }} </td>
          </ng-container>

          <!-- Daily Money Column -->
          <ng-container matColumnDef="dailyMoney">
            <th mat-header-cell *matHeaderCellDef> Daily Money</th>
            <td mat-cell *matCellDef="let slotMachine">
              <span *ngFor="let amount of slotMachine.daily_amounts">{{ amount.amount || 0 }}</span>
            </td>
          </ng-container>

          <!-- Actions Column -->
          <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef> Actions</th>
            <td mat-cell *matCellDef="let slotMachine">
              <button mat-button color="primary" (click)="close(slotMachine.id, slotMachine.bvbMoney)">
                Close Slot
              </button>
            </td>
          </ng-container>

          <!-- Table Header -->
          <tr mat-header-row *matHeaderRowDef="['name', 'brand', 'dailyMoney', 'actions']"></tr>

          <!-- Table Rows -->
          <tr mat-row *matRowDef="let row; columns: ['name', 'brand', 'dailyMoney', 'actions']"></tr>
        </table>

        <!-- Daily Total for the Hall -->
        <p><strong>Daily Money Sum:</strong> {{ hall.daily_money_sum }}</p>

      </div>
      <p><strong>Total Daily Amount for All Halls:</strong> {{ slotPitData.total_daily_amount }}</p>

      <!-- Overall Total for All Halls -->


    </div>
    <div class="progress-container">
      <div class="progress-card">
        <svg class="progress-bar" viewBox="0 0 100 50" width="200" height="120">
          <path class="background" d="M 10 50 A 40 40 0 0 1 90 50" stroke="lightgray" stroke-width="2"
                fill="none"></path>
          <path class="foreground" [attr.stroke-dasharray]="calculateStrokeDashArray()" stroke="green" stroke-width="2"
                fill="none" d="M 10 50 A 40 40 0 0 1 90 50"></path>

          <text x="0" y="10" font-size="8" fill="green">0</text>
          <text x="100" y="10" font-size="8" text-anchor="end" fill="green">{{ getMaxBvbMoney() }}</text>

          <text x="50" y="35" font-size="5" text-anchor="middle" fill="green">Total money</text>
          <text x="50" y="45" font-size="8" text-anchor="middle" fill="black">{{ 1000 }}</text>
        </svg>
      </div>

      <div class="slot-machine-by-brand">
        <table mat-table [dataSource]="brandsWithData" class="mat-elevation-z8" matSort>

          <!-- Brand Column -->
          <ng-container matColumnDef="brand">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Brand</th>
            <td mat-cell *matCellDef="let brandData"> {{ brandData.brand }} </td>
          </ng-container>

          <!-- Quantity Column -->
          <ng-container matColumnDef="quantity">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Quantity</th>
            <td mat-cell *matCellDef="let brandData"> {{ brandData.quantity }} </td>
          </ng-container>

          <!-- Total Money Column -->
          <ng-container matColumnDef="totalMoney">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Total Money</th>
            <td mat-cell *matCellDef="let brandData"> {{ brandData.totalMoney }} </td>
          </ng-container>

          <!-- Table Header and Row Definitions -->
          <tr mat-header-row *matHeaderRowDef="displayedColumnsForProgress"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumnsForProgress;"></tr>

        </table>
      </div>

      <div class="slot-machine-quantity">
        <h3> Active Slots: <span> {{ slotMachines.length }} </span></h3>
      </div>

    </div>
  </div>
</div>
